# STM32寄存器编程

基于STM32F103C8T6。

## 启动文件

启动文件：

> 摘自 —— [【初入电子坑之stm32篇（一）】初识stm32与寄存器编程 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/344913189)：
>
> 所有单片机都有这么一个东西，从运用的角度来看，我们无需深究它，只需对它的作用有个大概的感性认知即可。它的作用如下：
>
> - 在单片机上电之后，使用汇编指令对内核进行一些必要的初始化。
> - 利用汇编指令在stm32芯片上搭建了一个c语言的运行环境。
>
> （如果你想深挖这大哥的大概运用原理，这边建议你去刷一遍王爽的《汇编语言》）

## 第一个程序

1、新建Keil工程，选择STM32F103C8。

2、加入启动文件。

3、创建main.c和stm32f10x.h（该文件里面啥都不用写）。main.c内容如下，实现IO输出高电平：

```c
#include "stm32f10x.h"
/* 用引号表示在当前工程目录下找，找不到再去软件根目录 */
/* stm32f10x.h这个文件可以自己新建，里面什么都不用写 */

int main(void)
{
    
    /* 地址转为指针，再通过指针修改地址中的内容 */
    /* 通过与、或操作，实现修改寄存器指定的位而不修改其它的位 */
    /* 打开GPIOC端口的时钟 */
    *(volatile unsigned int *)0x40021018 |= (1 << 4);
    
    /* 配置IO口输出模式：位22、23配置为00则是推挽输出模式 */
    *(volatile unsigned int *)0x40011004 &= ~(1111 << 20);
    
    /* 配置为50MHz：位20、21配置为10则是最大速度10MHz，设置为11则是50MHz*/
    *(volatile unsigned int *)0x40011004 |= (1 << 20);
    
    /* 控制ODR寄存器来使IO口输出低电平：位13置0 */
    *(volatile unsigned int *)0x4001100C &= ~(1 << 13);
    
	/* 控制ODR寄存器来使IO口输出高电平：位13置1 */
    *(volatile unsigned int *)0x4001100C |= (1 << 13);
	while(1)
    {
        
    }
}
 
void SystemInit(void)
{ 
    /* 函数体为空，骗过编译器不报错 */
}
```









